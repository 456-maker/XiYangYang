<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>é­”æ³•å…ƒç´ é›†é»</title>
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: #f9f9f9;
}

/* âœ… ä¸­å¤®çª—æ ¼å¤§å¹…æ”¾å¤§ */
.container {
  width: 95%;
  max-width: 680px;          /* åŸ 500 â†’ æ”¾å¤§ */
  padding: 56px;             /* åŸ 36 â†’ æ”¾å¤§ */
  text-align: center;
  background: #fff;
  border-radius: 18px;       /* åœ“è§’åŒæ­¥æ”¾å¤§ */
  box-shadow: 0 8px 24px rgba(0,0,0,0.15);
}

/* âœ… å­—é«”å…¨é¢æ”¾å¤§ */
h1 {
  font-size: 2.3em;
  margin-bottom: 24px;
}

p {
  font-size: 1.7em;
  line-height: 1.6;
}

#message {
  margin-top: 32px;
  font-weight: bold;
  color: #007bff;
  font-size: 1.8em;
  white-space: pre-wrap;
}

.back-box {
  margin-top: 36px;
  padding: 18px 12px;
  background-color: #f5c400; /* é»ƒåº• */
  color: #ffffff;            /* ç™½å­— */
  border-radius: 12px;
  cursor: pointer;
  text-align: center;
  font-size: 1.4em;
  font-weight: bold;
  line-height: 1.4;
}

.back-box:hover {
  opacity: 0.9;
}

</style>
</head>

<body>

<div class="container">
  <h1 id="taskTitle">é­”æ³•å…ƒç´ ä»»å‹™</h1>
  <p id="taskDesc">ä»»å‹™èªªæ˜æ–‡å­—</p>
  <div id="message">é©—è­‰ä¸­ï¼Œè«‹ç¨å€™...</div>
  <div id="backToLine" class="back-box">
  <div>è«‹é»æ“Š</div>
  <div>çœ‹çœ‹å®ˆè­·è€…èªªäº†ä»€éº¼ï¼</div>
</div>

<script>
const WEB_APP_URL =
  "https://script.google.com/macros/s/AKfycbxjdQ2N_uYiLDSPa72H50aoPoma6KMYtwyGPfJ4IKGvzDAgK4cQb0aW078b9dYap4s/exec";

const LIFF_ID = "2008813911-7WAPqwiU";

const tasks = {
  "01": { title: "ç¬¬ä¸€ç«™ğŸŸ  æ©˜è‰²ï½œæ´»åŠ›èƒ½é‡", desc: "æ­å–œä½ ç²å¾—äº†ã€æ´»åŠ›èƒ½é‡ã€‘..." },
  "02": { title: "ç¬¬äºŒç«™âš« é»‘è‰²ï½œç¯€èƒ½ä¹‹åŠ›", desc: "æ­å–œä½ ç²å¾—äº†ã€ç¯€èƒ½ä¹‹åŠ›ã€‘..." },
  "03": { title: "ç¬¬ä¸‰ç«™ğŸŸ¢ ç¶ è‰²ï½œæ£®æ—å®ˆè­·", desc: "æ­å–œä½ ç²å¾—äº†ã€æ£®æ—å®ˆè­·ã€‘..." },
  "04": { title: "ç¬¬å››ç«™ğŸ”µ æ·ºè—è‰²ï½œæ¸…æ³‰ç¥ç¦", desc: "æ­å–œä½ ç²å¾—äº†ã€æ¸…æ³‰ç¥ç¦ã€‘..." },
  "05": { title: "ç¬¬äº”ç«™ğŸŸ£ ç´«è‰²ï½œæ™ºæ…§é­”æ³•", desc: "æ­å–œä½ ç²å¾—äº†ã€æ™ºæ…§é­”æ³•ã€‘..." },
  "06": { title: "ç¬¬å…­ç«™ğŸŸ¤ æ£•è‰²ï½œå¤§åœ°ä¹‹æ ¹", desc: "æ­å–œä½ ç²å¾—äº†ã€å¤§åœ°ä¹‹æ ¹ã€‘..." },
  "07": { title: "ç¬¬ä¸ƒç«™ğŸ”µ æ·±è—è‰²ï½œæµ·æ´‹ä¹‹åŠ›", desc: "æ­å–œä½ ç²å¾—äº†ã€æµ·æ´‹ä¹‹åŠ›ã€‘..." },
  "08": { title: "ç¬¬å…«ç«™ğŸ”´ ç´…è‰²ï½œæº«æš–ä¹‹å¿ƒ", desc: "æ­å–œä½ ç²å¾—äº†ã€æº«æš–ä¹‹å¿ƒã€‘..." },
  "09": { title: "ç¬¬ä¹ç«™ğŸŸ¡ é»ƒè‰²ï½œé™½å…‰é­”æ³•", desc: "æ­å–œä½ ç²å¾—äº†ã€é™½å…‰é­”æ³•ã€‘..." }
};

const urlParams = new URLSearchParams(window.location.search);
const station = urlParams.get("station");

if (!tasks[station]) {
  document.getElementById("taskTitle").innerText = "æ„Ÿæ‡‰éŒ¯èª¤";
  document.getElementById("taskDesc").innerText = "è«‹ç¢ºèªæƒæçš„ NFC æ˜¯å¦æ­£ç¢ºã€‚";
  document.getElementById("message").innerText = "";
} else {
  document.getElementById("taskTitle").innerText = tasks[station].title;
  document.getElementById("taskDesc").innerText = tasks[station].desc;
}

async function main() {
  try {
    await liff.init({ liffId: LIFF_ID });

    if (!liff.isLoggedIn()) {
      liff.login({ redirectUri: window.location.href });
      return;
    }

    const profile = await liff.getProfile();
    const userId = profile.userId;

    const res = await fetch(
      `${WEB_APP_URL}?lineId=${encodeURIComponent(userId)}&station=${encodeURIComponent(station)}`
    );
    const msg = await res.text();

    document.getElementById("message").innerText = msg;

    document.getElementById("backToLine").addEventListener("click", () => {
  if (liff.isInClient()) {
    liff.closeWindow(); // âœ… å›åˆ° LINE OA èŠå¤©å®¤
  } else {
    // è‹¥ä¸æ˜¯åœ¨ LINE è£¡æ‰“é–‹ï¼ˆä¾‹å¦‚ç”¨ç€è¦½å™¨ï¼‰
    window.location.href = "https://line.me";
  }
});

  } catch (err) {
    document.getElementById("message").innerText = "ç³»çµ±éŒ¯èª¤ï¼Œè«‹é‡æ–°æ“ä½œ";
    console.error(err);
  }
}

main();
</script>

</body>
</html>